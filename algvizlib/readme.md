# algvizlib设计原理

## 文件目录
+ `algviz.py` 定义基本数据结构（拓扑图、表格）的交互接口。
+ draw/ 绘图相关代码：
    + `graph.py` 绘制拓扑图和树。
    + `table.py` 绘制一维和二维数组。
    + `chart.py` 绘制一维直方图。
    + `utility.py` 定义一些公共函数（如：文本颜色配置，表格布局计算等）。
    + `svg.py` 生成各种形状的svg字符串以及使用dom解析svg。
    + `animation.py` 对对象中的节点进行动画操作。
+ test/ 测试相关代码：
    + `test_xxx.ipynb` 测试各对象功能是否正常。

## 前提条件

+ 假设算法在运行时只执行以下操作：
    + 创建并显示可视化对象。
    + 删除可视化对象。
    + 更新可视化对象：
        + 交换拓扑图中的两节点位置。
        + 添加、删除拓扑图中的节点或边。
        + 强调拓扑图中某些节点或边的颜色。
        + 刷新表格或直方图中的元素（包括添加和删除元素）。
        + 交换表格或直方图中两个元素的位置。
        + 强调表格或直方图中的某些元素。
    + 轨迹标注：
        + 轨迹用来标注当前访问过的（拓扑图、表格、直方图）内的（节点、元素），并对当前（节点、元素）进行强调（改变颜色、闪烁等）。
        + 对于所有探索过（拓扑图、表格、直方图）内的（节点、元素）进行颜色填充，*且颜色可以表现出访问次数的多少（有必要吗？）*。

## 交互接口

+ 【TODO】

## 绘制图形

### 图与树

+ 使用`Graphviz`三方库进行拓扑图和树的排版。

### 表格

+ 自己实现。

### 直方图

+ 自己实现。

### 其它注意点

+ 根据元素内填充的颜色自动调整文本颜色，文本颜色只设黑白两种。

## 动画效果

+ 直接对svg对象进行操作和更新，需要用到python的xml解析库（参考：[菜鸟教程](https://www.runoob.com/python3/python3-xml-processing.html)、[Python官方](https://docs.python.org/3/library/xml.dom.html)）。

+ 使用[SVG SMIL](https://www.zhangxinxu.com/wordpress/2014/08/so-powerful-svg-smil-animation/)
[参考](https://developer.mozilla.org/zh-CN/docs/Web/SVG/SVG_animation_with_SMIL)强大的效果来产生动画。
+ 拓扑图中两个节点交换动画：
    1. 计算两节点圆心之间的距离 $dist$ 。
    2. 两个节点分别向产生左右产生 $\delta x=r$ 的切向位移。
    3. 两节点分别沿原平移矢量方向移动 $dist$ 距离。
    4. 将两节点分别向左右移动至对方所在位置。


+ 拓扑图更新动画：
    1. 删节点：上一帧svg中要删除的节点淡出。
    2. 隐藏边：上一帧svg中的所有边淡出。
    3. 移动节点：线性移动所有节点。
    4. 移动边：线性移动所有边。
    5. 显示边：所有未被删除的边淡入。
    4. 添加节点和边：要被添加的节点和边淡入。


+ 表格更新动画：
    + 【TODO】